<%# --- Global Styles & Fonts Import --- %>
<%# „Åó„Å£„ÅΩ„ÇäÊòéÊúù„Éï„Ç©„É≥„Éà„ÅÆË™≠„ÅøËæº„Åø %>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@600&display=swap" rel="stylesheet">

<%# ÂÖ®‰Ωì„ÅÆ„É©„ÉÉ„Éë„ÉºÔºöLP„Å®Âêå„ÅòËÉåÊôØËâ≤„Å®„Éï„Ç©„É≥„ÉàË®≠ÂÆö %>
<div class="min-h-screen bg-[#FDFBF7] text-slate-700 font-sans selection:bg-amber-100 selection:text-amber-900">
  
  <%# --- Header (LP„Çπ„Çø„Ç§„É´) --- %>
  <header class="w-full py-6 px-6 flex flex-col md:flex-row justify-between items-center max-w-6xl mx-auto z-50 relative gap-4 md:gap-0">
    
    <%# „É≠„Ç¥ÈÉ®ÂàÜ: üëò + „Åó„Å£„ÅΩ„ÇäÊòéÊúù %>
    <%= link_to root_path, class: "flex items-center gap-3 text-indigo-950 hover:opacity-80 transition duration-300" do %>
      <span class="text-3xl filter drop-shadow-sm">üëò</span>
      <span class="text-3xl font-bold tracking-widest" style="font-family: 'Shippori Mincho', serif;">
        „Éí„Éà„Éé„Éè„Ç¥„É≠„É¢
      </span>
    <% end %>

    <%# „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ %>
    <nav class="flex items-center gap-4 sm:gap-6 text-sm font-bold text-indigo-900 overflow-x-auto w-full md:w-auto justify-center md:justify-end py-2 no-scrollbar">
      <%# „Ç´„É¨„É≥„ÉÄ„Éº„Å∏„ÅÆÊ≠£„Åó„ÅÑ„Éë„Çπ„ÇíË®≠ÂÆö %>
      <%= link_to "„Ç´„É¨„É≥„ÉÄ„Éº", actual_outfits_path, class: "whitespace-nowrap hover:text-amber-700 transition" %>
      
      <%# ‰ºö„ÅÜ‰∫∫„ÅÆÁÆ°ÁêÜ„Å∏„ÅÆÊ≠£„Åó„ÅÑ„Éë„Çπ„ÇíË®≠ÂÆö %>
      <%= link_to "‰ºö„ÅÜ‰∫∫„ÅÆÁÆ°ÁêÜ", contacts_path, class: "whitespace-nowrap hover:text-amber-700 transition" %>
      
      <%# „Ç¢„Ç§„ÉÜ„É†‰∏ÄË¶ßÔºàÁèæÂú®Âú∞Ôºâ %>
      <%= link_to "„ÇØ„É≠„Éº„Çº„ÉÉ„Éà", items_path, class: "whitespace-nowrap text-amber-700 border-b-2 border-amber-700" %>
      
      <% if user_signed_in? %>
        <%= button_to "„É≠„Ç∞„Ç¢„Ç¶„Éà", destroy_user_session_path, method: :delete, class: "whitespace-nowrap bg-red-400 text-white px-4 py-2 rounded-full hover:bg-red-500 transition shadow-sm cursor-pointer border-none text-sm font-bold" %>
      <% else %>
        <%= link_to "„É≠„Ç∞„Ç§„É≥", new_user_session_path, class: "whitespace-nowrap bg-indigo-600 text-white px-4 py-2 rounded-full hover:bg-indigo-700 transition" %>
      <% end %>
    </nav>
  </header>

  <%# --- Main Content (Dashboard Layout) --- %>
  <main class="max-w-6xl mx-auto px-4 sm:px-6 py-8">
    
    <%# „Éï„É©„ÉÉ„Ç∑„É•„É°„ÉÉ„Çª„Éº„Ç∏ (ÈÄöÁü•) %>
    <% if notice %>
      <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-6 rounded shadow-sm animate-fade-in-down" role="alert">
        <p class="font-bold">„ÅäÁü•„Çâ„Åõ</p>
        <p><%= notice %></p>
      </div>
    <% end %>
    <% if alert %>
      <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded shadow-sm animate-fade-in-down" role="alert">
        <p class="font-bold">Ê≥®ÊÑè</p>
        <p><%= alert %></p>
      </div>
    <% end %>

    <div class="flex flex-col lg:flex-row gap-8">
      
      <%# --- Left Sidebar (Ê§úÁ¥¢„Éª„É°„Éã„É•„Éº) --- %>
      <aside class="w-full lg:w-1/4 space-y-6">
        
        <%# „É°„Éã„É•„Éº %>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
          <h2 class="text-xl font-bold text-indigo-950 mb-4" style="font-family: 'Shippori Mincho', serif;">ÁßÅ„ÅÆ„ÇØ„É≠„Éº„Çº„ÉÉ„Éà</h2>
          
          <%= link_to new_item_path, class: "block w-full text-center bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-md mb-4 flex items-center justify-center gap-2" do %>
             <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
             Êñ∞„Åó„ÅèÁôªÈå≤„Åô„Çã
          <% end %>
          
          <%= link_to actual_outfits_path, class: "block w-full text-center bg-white border-2 border-slate-200 text-slate-600 font-bold py-3 px-4 rounded-xl hover:bg-slate-50 transition" do %>
            üìÖ ÁùÄÁî®„Ç´„É¨„É≥„ÉÄ„Éº
          <% end %>
        </div>

        <%# ‰∏¶„ÅπÊõø„Åà„Éª„Éï„Ç£„É´„ÇøÔºà„Åì„Åì„Çí‰øÆÊ≠£„Åó„Åæ„Åó„ÅüÔºâ %>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
          <h3 class="font-bold text-slate-500 mb-4 text-sm flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"></path></svg>
            ‰∏¶„ÅπÊõø„Åà
          </h3>
          <ul class="space-y-2 text-sm">
            <% 
              sort_options = {
                'newest' => 'Êñ∞„Åó„ÅÑÈ†Ü',
                'oldest' => 'Âè§„ÅÑÈ†Ü',
                'price_low' => '‰æ°Ê†º„ÅåÂÆâ„ÅÑÈ†Ü',
                'price_high' => '‰æ°Ê†º„ÅåÈ´ò„ÅÑÈ†Ü'
              }
            %>
            <% sort_options.each do |key, label| %>
              <% is_active = (params[:sort] == key) || (params[:sort].nil? && key == 'newest') %>
              <li>
                <%= link_to request.params.merge(sort: key), class: "block p-2 rounded transition #{is_active ? 'bg-amber-50 text-amber-800 font-bold ring-1 ring-amber-200' : 'text-slate-600 hover:bg-slate-50'}" do %>
                  <div class="flex items-center justify-between">
                    <span><%= label %></span>
                    <% if is_active %>
                      <span class="text-amber-500">‚óè</span>
                    <% end %>
                  </div>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>

        <%# „Ç´„ÉÜ„Ç¥„É™„Éï„Ç£„É´„ÇøÔºàËøΩÂä†Ôºâ %>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hidden lg:block">
           <h3 class="font-bold text-slate-500 mb-4 text-sm flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path></svg>
            „Ç´„ÉÜ„Ç¥„É™„ÅßÁµû„ÇäËæº„ÇÄ
          </h3>
          <ul class="space-y-1 text-sm">
             <li>
               <%= link_to "„Åô„Åπ„Å¶Ë°®Á§∫", request.params.merge(category_id: nil), class: "block px-2 py-1.5 rounded #{params[:category_id].blank? ? 'text-amber-800 font-bold bg-amber-50' : 'text-slate-600 hover:text-amber-700'}" %>
             </li>
             <% Category.all.each do |cat| %>
               <li>
                 <%= link_to cat.name, request.params.merge(category_id: cat.id), class: "block px-2 py-1.5 rounded #{params[:category_id].to_s == cat.id.to_s ? 'text-amber-800 font-bold bg-amber-50' : 'text-slate-600 hover:text-amber-700'}" %>
               </li>
             <% end %>
          </ul>
        </div>
      </aside>

      <%# --- Right Content (Grid Items) --- %>
      <div class="w-full lg:w-3/4">
        <div class="flex justify-between items-end mb-6">
          <h2 class="text-2xl font-bold text-indigo-950" style="font-family: 'Shippori Mincho', serif;">
            <% if params[:category_id] && cat = Category.find_by(id: params[:category_id]) %>
              <%= cat.name %>
            <% else %>
              „Åô„Åπ„Å¶„ÅÆ„Ç¢„Ç§„ÉÜ„É†
            <% end %>
          </h2>
          <span class="text-slate-500 text-sm bg-white px-3 py-1 rounded-full shadow-sm border border-slate-100">
            ÂÖ® <span class="font-bold text-indigo-900"><%= @items.count %></span> ‰ª∂
          </span>
        </div>

        <% if @items.any? %>
          <%# „Ç¢„Ç§„ÉÜ„É†„Ç∞„É™„ÉÉ„Éâ %>
          <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
            <% @items.each do |item| %>
              <div class="group bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-xl hover:shadow-indigo-100 transition duration-300 border border-slate-100 flex flex-col h-full ring-1 ring-transparent hover:ring-amber-200">
                <%# ÁîªÂÉè„Ç®„É™„Ç¢ %>
                <div class="relative aspect-[3/4] bg-slate-100 overflow-hidden">
                  <% if item.image.attached? %>
                    <%= image_tag item.image, class: "w-full h-full object-cover group-hover:scale-110 transition duration-700 ease-out" %>
                  <% else %>
                    <div class="flex flex-col items-center justify-center h-full text-slate-300">
                      <svg class="w-12 h-12 mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                      <span class="text-xs font-bold tracking-widest">NO IMAGE</span>
                    </div>
                  <% end %>

                  <%# „Éõ„Éê„ÉºÊôÇ„ÅÆ„ÄåË©≥Á¥∞„ÇíË¶ã„Çã„Äç„Ç™„Éº„Éê„Éº„É¨„Ç§ %>
                  <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition flex items-center justify-center backdrop-blur-[1px]">
                    <%= link_to item_path(item), class: "bg-white text-indigo-950 text-xs font-bold px-5 py-2.5 rounded-full shadow-lg transform translate-y-4 group-hover:translate-y-0 transition duration-300 hover:bg-amber-50" do %>
                      Ë©≥Á¥∞„ÇíË¶ã„Çã
                    <% end %>
                  </div>

                  <%# Â∑¶‰∏ä„ÅÆ„Ç´„ÉÜ„Ç¥„É™„É©„Éô„É´ %>
                  <% if item.category %>
                    <div class="absolute top-2 left-2">
                       <span class="inline-block bg-white/90 backdrop-blur-sm text-slate-600 text-[10px] px-2 py-1 rounded-md font-bold shadow-sm">
                        <%= item.category.name %>
                      </span>
                    </div>
                  <% end %>
                </div>

                <%# „ÉÜ„Ç≠„Çπ„ÉàÊÉÖÂ†± %>
                <div class="p-4 flex flex-col flex-grow">
                  <h3 class="font-bold text-indigo-950 mb-1 line-clamp-1 group-hover:text-amber-700 transition"><%= item.name %></h3>
                  <div class="mt-auto flex justify-between items-end border-t border-slate-50 pt-3">
                    <p class="text-[10px] text-slate-400">
                      <%= item.created_at.strftime('%Y.%m.%d') %>
                    </p>
                    <% if item.price.present? %>
                      <p class="text-sm font-bold text-slate-700 font-mono">
                        ¬•<%= item.price.to_fs(:delimited) %>
                      </p>
                    <% end %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
           <%# „Ç¢„Ç§„ÉÜ„É†„Åå„Å™„ÅÑÂ†¥Âêà %>
           <div class="bg-white rounded-3xl p-10 text-center border-2 border-dashed border-slate-200">
             <p class="text-slate-400 font-bold mb-4">Ë°®Á§∫„Åô„Çã„Ç¢„Ç§„ÉÜ„É†„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
             <%= link_to "Êù°‰ª∂„Çí„É™„Çª„ÉÉ„Éà", items_path, class: "text-amber-600 font-bold hover:underline" %>
           </div>
        <% end %>
        
      </div>
    </div>
  </main>
</div>

<style>
/* „Çπ„Éû„Éõ„Åß„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Ê®™„Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÇíÈö†„Åô */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
</style>